--[[
    AzureUI v2.1 - Fixed Toggle Animations & Mobile Support
]]

local AzureUI = {}
AzureUI.__index = AzureUI

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

local Icons = {
    ["x"] = "rbxassetid://7733658504",
    ["minus"] = "rbxassetid://7733764353",
    ["home"] = "rbxassetid://7733963888",
    ["settings"] = "rbxassetid://7733973200",
    ["user"] = "rbxassetid://7733970256",
    ["menu"] = "rbxassetid://7733901624",
    ["check"] = "rbxassetid://7733710700",
    ["chevron-down"] = "rbxassetid://7733715403",
    ["bell"] = "rbxassetid://7733673125",
    ["info"] = "rbxassetid://7733954058",
}

local Theme = {
    Background = Color3.fromRGB(15, 15, 15),
    Accent = Color3.fromRGB(88, 101, 242),
    Secondary = Color3.fromRGB(35, 35, 35),
    Text = Color3.fromRGB(255, 255, 255),
    SubText = Color3.fromRGB(200, 200, 200),
    CornerRadius = UDim.new(0, 12)
}

local function Create(instanceType, properties)
    local instance = Instance.new(instanceType)
    for prop, value in pairs(properties or {}) do
        instance[prop] = value
    end
    return instance
end

local function Tween(instance, properties, duration, easingStyle, easingDirection)
    local tweenInfo = TweenInfo.new(
        duration or 0.3, 
        easingStyle or Enum.EasingStyle.Quart, 
        easingDirection or Enum.EasingDirection.Out
    )
    local tween = TweenService:Create(instance, tweenInfo, properties)
    tween:Play()
    return tween
end

local function GetIcon(iconName)
    return Icons[iconName] or Icons["home"]
end

-- Mobile Toggle GUI (Always ready)
local MobileGui = Create("ScreenGui", {
    Name = "AzureMobileToggle",
    Parent = CoreGui,
    ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
    DisplayOrder = 999,
    Enabled = false
})

local MobileBtnContainer = Create("Frame", {
    Name = "MobileContainer",
    Parent = MobileGui,
    Size = UDim2.new(1, 0, 0, 70),
    Position = UDim2.new(0, 0, 0, 10),
    BackgroundTransparency = 1
})

local MobileBtn = Create("TextButton", {
    Name = "MobileToggle",
    Parent = MobileBtnContainer,
    Size = UDim2.new(0, 50, 0, 50),
    Position = UDim2.new(0.5, -25, 0, 0),
    BackgroundColor3 = Theme.Accent,
    Text = "",
    AutoButtonColor = false,
    ClipsDescendants = true,
    Visible = false -- Hidden initially
})

Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = MobileBtn})
Create("UIStroke", {Color = Color3.new(1,1,1), Thickness = 2, Transparency = 0.3, Parent = MobileBtn})

Create("ImageLabel", {
    Size = UDim2.new(0, 24, 0, 24),
    Position = UDim2.new(0.5, 0, 0.5, 0),
    AnchorPoint = Vector2.new(0.5, 0.5),
    BackgroundTransparency = 1,
    Image = GetIcon("menu"),
    ImageColor3 = Color3.new(1, 1, 1),
    Parent = MobileBtn
})

-- Ripple effect for mobile button
local function createRipple(parent)
    local ripple = Create("Frame", {
        Parent = parent,
        BackgroundColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 0.6,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 0, 0, 0),
        AnchorPoint = Vector2.new(0.5, 0.5)
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = ripple})
    Tween(ripple, {Size = UDim2.new(2, 0, 2, 0), BackgroundTransparency = 1}, 0.5)
    task.wait(0.5)
    ripple:Destroy()
end

function AzureUI:CreateWindow(config)
    config = config or {}
    local Window = {}
    setmetatable(Window, AzureUI)
    
    local titleText = config.Title or "AzureUI"
    local windowSize = config.Size or UDim2.new(0, 800, 0, 450)
    local logo = config.Logo
    
    -- Check if mobile
    local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
    MobileGui.Enabled = true
    
    Window.Gui = Create("ScreenGui", {
        Name = "AzureUI_" .. tostring(math.random(1000, 9999)),
        Parent = CoreGui,
        ResetOnSpawn = false,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    })
    
    Window.ToggleKey = config.ToggleKey or Enum.KeyCode.RightShift
    
    -- Main Panel
    Window.Main = Create("Frame", {
        Name = "MainPanel",
        Parent = Window.Gui,
        BackgroundColor3 = Theme.Background,
        BackgroundTransparency = 0.15,
        BorderSizePixel = 0,
        Position = UDim2.new(0.5, -windowSize.X.Offset/2, 0.5, -windowSize.Y.Offset/2),
        Size = UDim2.new(0, 0, 0, 0), -- Start small for animation
        ClipsDescendants = true,
        Visible = false -- Start hidden
    })
    
    -- Glass effect
    local glass = Create("ImageLabel", {
        Name = "GlassEffect",
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Image = "rbxassetid://5587865193",
        ImageColor3 = Color3.new(0.1, 0.1, 0.1),
        ImageTransparency = 0.9,
        ScaleType = Enum.ScaleType.Slice,
        SliceCenter = Rect.new(10, 10, 118, 118),
        ZIndex = 0
    })
    glass.Parent = Window.Main
    
    Create("UICorner", {CornerRadius = Theme.CornerRadius, Parent = Window.Main})
    Create("UIStroke", {
        Color = Color3.fromRGB(60, 60, 60), 
        Thickness = 1.5, 
        Transparency = 0.5,
        Parent = Window.Main
    })
    
    -- Title Bar
    Window.TitleBar = Create("Frame", {
        Name = "TitleBar",
        Parent = Window.Main,
        BackgroundColor3 = Color3.fromRGB(20, 20, 20),
        BackgroundTransparency = 0.3,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 10, 0, 10),
        Size = UDim2.new(1, -20, 0, 48)
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = Window.TitleBar})
    
    -- Title with Logo
    local titleContainer = Create("Frame", {
        Parent = Window.TitleBar,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 12, 0, 0),
        Size = UDim2.new(0.6, 0, 1, 0)
    })
    
    local titleLayout = Create("UIListLayout", {
        Parent = titleContainer,
        FillDirection = Enum.FillDirection.Horizontal,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10),
        VerticalAlignment = Enum.VerticalAlignment.Center
    })
    
    if logo then
        local logoImg = Create("ImageLabel", {
            Parent = titleContainer,
            Size = UDim2.new(0, 32, 0, 32),
            BackgroundTransparency = 1,
            Image = logo,
            LayoutOrder = 1
        })
        Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = logoImg})
    end
    
    Create("TextLabel", {
        Parent = titleContainer,
        LayoutOrder = 2,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 0, 1, 0),
        AutomaticSize = Enum.AutomaticSize.X,
        Font = Enum.Font.GothamBold,
        Text = titleText,
        TextColor3 = Theme.Text,
        TextSize = 20,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Control Buttons
    local btnContainer = Create("Frame", {
        Parent = Window.TitleBar,
        BackgroundTransparency = 1,
        Position = UDim2.new(1, -100, 0, 8),
        Size = UDim2.new(0, 90, 0, 32)
    })
    
    Create("UIListLayout", {
        Parent = btnContainer,
        FillDirection = Enum.FillDirection.Horizontal,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 8),
        HorizontalAlignment = Enum.HorizontalAlignment.Right
    })
    
    -- Minimize Button
    local minimizeBtn = Create("ImageButton", {
        Parent = btnContainer,
        LayoutOrder = 1,
        BackgroundColor3 = Color3.fromRGB(255, 170, 0),
        Size = UDim2.new(0, 28, 0, 28),
        Image = GetIcon("minus"),
        AutoButtonColor = false
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = minimizeBtn})
    
    -- Close Button
    local closeBtn = Create("ImageButton", {
        Parent = btnContainer,
        LayoutOrder = 2,
        BackgroundColor3 = Color3.fromRGB(255, 75, 75),
        Size = UDim2.new(0, 28, 0, 28),
        Image = GetIcon("x"),
        AutoButtonColor = false
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = closeBtn})
    
    -- Tab Container
    Window.TabContainer = Create("Frame", {
        Name = "Tabs",
        Parent = Window.Main,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 10, 0, 70),
        Size = UDim2.new(0, 140, 1, -80)
    })
    
    -- Content Area
    Window.ContentFrame = Create("ScrollingFrame", {
        Name = "Content",
        Parent = Window.Main,
        BackgroundColor3 = Color3.fromRGB(25, 25, 25),
        BackgroundTransparency = 0.5,
        BorderSizePixel = 0,
        Position = UDim2.new(0, 160, 0, 70),
        Size = UDim2.new(1, -170, 1, -80),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 6,
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        ScrollBarImageColor3 = Theme.Accent
    })
    Create("UICorner", {CornerRadius = Theme.CornerRadius, Parent = Window.ContentFrame})
    
    Create("UIPadding", {
        Parent = Window.ContentFrame,
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        PaddingTop = UDim.new(0, 15),
        PaddingBottom = UDim.new(0, 15)
    })
    
    Create("UIListLayout", {
        Parent = Window.ContentFrame,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 12)
    })
    
    Window.Tabs = {}
    Window.ActiveTab = nil
    Window.Keybinds = {}
    Window.IsOpen = true
    
    -- Animation Functions
    function Window:Open()
        Window.IsOpen = true
        Window.Gui.Enabled = true
        Window.Main.Visible = true
        
        -- Hide mobile button
        MobileBtn.Visible = false
        
        -- Scale + Fade In Animation
        Window.Main.Size = UDim2.new(0, 0, 0, 0)
        Window.Main.BackgroundTransparency = 1
        
        Tween(Window.Main, {Size = windowSize}, 0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
        Tween(Window.Main, {BackgroundTransparency = 0.15}, 0.3)
        
        -- Fade in content
        Window.Main.GroupTransparency = 1
        Tween(Window.Main, {GroupTransparency = 0}, 0.3)
    end
    
    function Window:Close()
        Window.IsOpen = false
        
        -- Scale + Fade Out Animation
        Tween(Window.Main, {Size = UDim2.new(0, 0, 0, 0)}, 0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.In)
        Tween(Window.Main, {BackgroundTransparency = 1}, 0.25)
        
        task.wait(0.3)
        Window.Main.Visible = false
        Window.Gui.Enabled = false
        
        -- Show mobile button with animation
        if isMobile then
            MobileBtn.Visible = true
            MobileBtn.Size = UDim2.new(0, 0, 0, 0)
            Tween(MobileBtn, {Size = UDim2.new(0, 50, 0, 50)}, 0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
        end
    end
    
    function Window:Toggle()
        if Window.IsOpen then
            Window:Close()
        else
            Window:Open()
        end
    end
    
    -- Initial Open
    task.spawn(function()
        task.wait(0.1)
        Window:Open()
    end)
    
    -- Button Events
    closeBtn.MouseButton1Click:Connect(function()
        Window:Close()
    end)
    
    minimizeBtn.MouseButton1Click:Connect(function()
        Window:Close()
    end)
    
    -- Mobile Button Event
    MobileBtn.MouseButton1Click:Connect(function()
        createRipple(MobileBtn)
        Window:Open()
    end)
    
    -- Dragging
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    Window.TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = Window.Main.Position
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            Window.Main.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X, 
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    
    -- Keybind Toggle
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end
        
        if input.KeyCode == Window.ToggleKey then
            Window:Toggle()
        end
        
        for _, bind in pairs(Window.Keybinds) do
            if input.KeyCode == bind.Key and bind.Callback then
                bind.Callback()
            end
        end
    end)
    
    return Window
end

-- Create Tab
function AzureUI:CreateTab(config)
    local Window = self
    config = config or {}
    local name = config.Name or "Tab"
    local icon = config.Icon
    local Tab = {}
    
    local tabBtn = Create("TextButton", {
        Name = name,
        Parent = Window.TabContainer,
        BackgroundColor3 = Theme.Secondary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, 40),
        Font = Enum.Font.GothamSemibold,
        Text = "",
        AutoButtonColor = false,
        LayoutOrder = #Window.Tabs + 1
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = tabBtn})
    
    local contentContainer = Create("Frame", {
        Parent = Window.ContentFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Visible = false
    })
    
    Create("UIListLayout", {
        Parent = contentContainer,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10)
    })
    
    Create("UIPadding", {
        Parent = tabBtn,
        PaddingLeft = UDim.new(0, 12),
        PaddingRight = UDim.new(0, 12)
    })
    
    local tabLayout = Create("UIListLayout", {
        Parent = tabBtn,
        FillDirection = Enum.FillDirection.Horizontal,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10),
        VerticalAlignment = Enum.VerticalAlignment.Center
    })
    
    if icon then
        local tabIcon = Create("ImageLabel", {
            Parent = tabBtn,
            Size = UDim2.new(0, 20, 0, 20),
            BackgroundTransparency = 1,
            Image = GetIcon(icon),
            ImageColor3 = Theme.SubText,
            LayoutOrder = 1
        })
        Tab.Icon = tabIcon
    end
    
    local tabText = Create("TextLabel", {
        Parent = tabBtn,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, icon and -30 or 0, 1, 0),
        Font = Enum.Font.GothamSemibold,
        Text = name,
        TextColor3 = Theme.SubText,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left,
        LayoutOrder = 2
    })
    
    -- Tab Switch Animation
    tabBtn.MouseButton1Click:Connect(function()
        if Window.ActiveTab == Tab then return end
        
        if Window.ActiveTab then
            Tween(Window.ActiveTab.Button, {BackgroundColor3 = Theme.Secondary}, 0.3)
            if Window.ActiveTab.Icon then
                Tween(Window.ActiveTab.Icon, {ImageColor3 = Theme.SubText}, 0.3)
            end
            Window.ActiveTab.Button:FindFirstChildWhichIsA("TextLabel").TextColor3 = Theme.SubText
            Window.ActiveTab.Content.Visible = false
        end
        
        Window.ActiveTab = Tab
        Tween(tabBtn, {BackgroundColor3 = Theme.Accent}, 0.3)
        if Tab.Icon then
            Tween(Tab.Icon, {ImageColor3 = Color3.new(1, 1, 1)}, 0.3)
        end
        Tween(tabText, {TextColor3 = Color3.new(1, 1, 1)}, 0.3)
        
        Tab.Content.Visible = true
        Tab.Content.Position = UDim2.new(0.05, 0, 0, 0)
        Tween(Tab.Content, {Position = UDim2.new(0, 0, 0, 0)}, 0.3, Enum.EasingStyle.Back)
    end)
    
    Tab.Button = tabBtn
    Tab.Content = contentContainer
    
    if not Window.ActiveTab then
        Window.ActiveTab = Tab
        tabBtn.BackgroundColor3 = Theme.Accent
        tabText.TextColor3 = Color3.new(1, 1, 1)
        if Tab.Icon then
            Tab.Icon.ImageColor3 = Color3.new(1, 1, 1)
        end
        Tab.Content.Visible = true
    end
    
    table.insert(Window.Tabs, Tab)
    return Tab
end

-- Create Toggle
function AzureUI:CreateToggle(config)
    local Tab = self
    config = config or {}
    
    local frame = Create("Frame", {
        Parent = Tab.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 42)
    })
    
    local container = Create("Frame", {
        Parent = frame,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundColor3 = Theme.Secondary,
        BackgroundTransparency = 0.5
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = container})
    
    Create("UIPadding", {
        Parent = container,
        PaddingLeft = UDim.new(0, 12),
        PaddingRight = UDim.new(0, 12)
    })
    
    Create("UIListLayout", {
        Parent = container,
        FillDirection = Enum.FillDirection.Horizontal,
        Padding = UDim.new(0, 10),
        VerticalAlignment = Enum.VerticalAlignment.Center
    })
    
    if config.Icon then
        Create("ImageLabel", {
            Parent = container,
            Size = UDim2.new(0, 20, 0, 20),
            BackgroundTransparency = 1,
            Image = GetIcon(config.Icon),
            ImageColor3 = Theme.SubText,
            LayoutOrder = 1
        })
    end
    
    Create("TextLabel", {
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 1, 0),
        Font = Enum.Font.Gotham,
        Text = config.Name or "Toggle",
        TextColor3 = Color3.fromRGB(220, 220, 220),
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left,
        LayoutOrder = 2
    })
    
    local switch = Create("TextButton", {
        Parent = container,
        BackgroundColor3 = Theme.ToggleOff,
        Size = UDim2.new(0, 44, 0, 24),
        Text = "",
        AutoButtonColor = false,
        LayoutOrder = 3
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = switch})
    
    local indicator = Create("Frame", {
        Parent = switch,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Position = UDim2.new(0, 3, 0.5, -9),
        Size = UDim2.new(0, 18, 0, 18)
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = indicator})
    
    local enabled = config.Default or false
    if enabled then
        switch.BackgroundColor3 = Theme.ToggleOn
        indicator.Position = UDim2.new(1, -21, 0.5, -9)
    end
    
    switch.MouseButton1Click:Connect(function()
        enabled = not enabled
        if enabled then
            Tween(indicator, {Position = UDim2.new(1, -21, 0.5, -9)}, 0.3, Enum.EasingStyle.Back)
            Tween(switch, {BackgroundColor3 = Theme.ToggleOn}, 0.3)
        else
            Tween(indicator, {Position = UDim2.new(0, 3, 0.5, -9)}, 0.3, Enum.EasingStyle.Back)
            Tween(switch, {BackgroundColor3 = Theme.ToggleOff}, 0.3)
        end
        
        if config.Callback then
            config.Callback(enabled)
        end
    end)
    
    return frame
end

-- Create Slider
function AzureUI:CreateSlider(config)
    local Tab = self
    config = config or {}
    
    local frame = Create("Frame", {
        Parent = Tab.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 60)
    })
    
    local container = Create("Frame", {
        Parent = frame,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundColor3 = Theme.Secondary,
        BackgroundTransparency = 0.5
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = container})
    
    Create("UIPadding", {
        Parent = container,
        PaddingLeft = UDim.new(0, 12),
        PaddingRight = UDim.new(0, 12),
        PaddingTop = UDim.new(0, 10),
        PaddingBottom = UDim.new(0, 10)
    })
    
    local titleRow = Create("Frame", {
        Parent = container,
        Size = UDim2.new(1, 0, 0, 20),
        BackgroundTransparency = 1
    })
    
    Create("TextLabel", {
        Parent = titleRow,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 1, 0),
        Font = Enum.Font.Gotham,
        Text = config.Name or "Slider",
        TextColor3 = Color3.fromRGB(220, 220, 220),
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local valueLabel = Create("TextLabel", {
        Parent = titleRow,
        BackgroundTransparency = 1,
        Position = UDim2.new(0.7, 0, 0, 0),
        Size = UDim2.new(0.3, 0, 1, 0),
        Font = Enum.Font.GothamBold,
        Text = tostring(config.Default or config.Min or 0),
        TextColor3 = Theme.Accent,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Right
    })
    
    local sliderBg = Create("Frame", {
        Parent = container,
        BackgroundColor3 = Color3.fromRGB(50, 50, 50),
        Position = UDim2.new(0, 0, 0, 35),
        Size = UDim2.new(1, 0, 0, 8)
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = sliderBg})
    
    local fill = Create("Frame", {
        Parent = sliderBg,
        BackgroundColor3 = Theme.Accent,
        Size = UDim2.new(0.5, 0, 1, 0)
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = fill})
    
    local knob = Create("TextButton", {
        Parent = sliderBg,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Position = UDim2.new(0.5, -10, 0.5, -10),
        Size = UDim2.new(0, 20, 0, 20),
        Text = "",
        AutoButtonColor = false
    })
    Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = knob})
    
    -- Value popup
    local popup = Create("Frame", {
        Parent = knob,
        BackgroundColor3 = Theme.Accent,
        Size = UDim2.new(0, 40, 0, 24),
        Position = UDim2.new(0.5, -20, 0, -32),
        BackgroundTransparency = 1,
        Visible = false
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = popup})
    
    Create("TextLabel", {
        Parent = popup,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Font = Enum.Font.GothamBold,
        Text = "50",
        TextColor3 = Color3.new(1, 1, 1),
        TextSize = 12
    })
    
    local min = config.Min or 0
    local max = config.Max or 100
    local value = config.Default or min
    
    local function update(input)
        local pos = math.clamp((input.Position.X - sliderBg.AbsolutePosition.X) / sliderBg.AbsoluteSize.X, 0, 1)
        value = min + (pos * (max - min))
        value = math.floor(value)
        
        fill.Size = UDim2.new(pos, 0, 1, 0)
        knob.Position = UDim2.new(pos, -10, 0.5, -10)
        valueLabel.Text = tostring(value)
        popup:FindFirstChildWhichIsA("TextLabel").Text = tostring(value)
        
        if config.Callback then
            config.Callback(value)
        end
    end
    
    local dragging = false
    local function startDrag(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            popup.Visible = true
            Tween(popup, {BackgroundTransparency = 0}, 0.2)
            update(input)
        end
    end
    
    knob.InputBegan:Connect(startDrag)
    sliderBg.InputBegan:Connect(startDrag)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            update(input)
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
            Tween(popup, {BackgroundTransparency = 1}, 0.2)
            task.wait(0.2)
            popup.Visible = false
        end
    end)
    
    return frame
end

-- Create Button
function AzureUI:CreateButton(config)
    local Tab = self
    config = config or {}
    
    local btn = Create("TextButton", {
        Parent = Tab.Content,
        BackgroundColor3 = Theme.Accent,
        Size = UDim2.new(1, 0, 0, 40),
        Font = Enum.Font.GothamBold,
        Text = "",
        TextColor3 = Color3.new(1, 1, 1),
        TextSize = 14,
        AutoButtonColor = false,
        ClipsDescendants = true
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = btn})
    
    Create("UIListLayout", {
        Parent = btn,
        FillDirection = Enum.FillDirection.Horizontal,
        Padding = UDim.new(0, 10),
        VerticalAlignment = Enum.VerticalAlignment.Center,
        HorizontalAlignment = Enum.HorizontalAlignment.Center
    })
    
    if config.Icon then
        Create("ImageLabel", {
            Parent = btn,
            Size = UDim2.new(0, 20, 0, 20),
            BackgroundTransparency = 1,
            Image = GetIcon(config.Icon),
            ImageColor3 = Color3.new(1, 1, 1),
            LayoutOrder = 1
        })
    end
    
    Create("TextLabel", {
        Parent = btn,
        BackgroundTransparency = 1,
        AutomaticSize = Enum.AutomaticSize.XY,
        Font = Enum.Font.GothamBold,
        Text = config.Name or "Button",
        TextColor3 = Color3.new(1, 1, 1),
        TextSize = 14,
        LayoutOrder = 2
    })
    
    btn.MouseEnter:Connect(function()
        Tween(btn, {BackgroundColor3 = Color3.fromRGB(60, 73, 210)}, 0.2)
    end)
    
    btn.MouseLeave:Connect(function()
        Tween(btn, {BackgroundColor3 = Theme.Accent}, 0.2)
    end)
    
    btn.MouseButton1Click:Connect(function()
        local ripple = Create("Frame", {
            Parent = btn,
            BackgroundColor3 = Color3.new(1, 1, 1),
            BackgroundTransparency = 0.5,
            Position = UDim2.new(0.5, 0, 0.5, 0),
            Size = UDim2.new(0, 0, 0, 0),
            AnchorPoint = Vector2.new(0.5, 0.5)
        })
        Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = ripple})
        
        Tween(ripple, {Size = UDim2.new(1.5, 0, 1.5, 0), BackgroundTransparency = 1}, 0.5)
        task.wait(0.5)
        ripple:Destroy()
        
        if config.Callback then
            config.Callback()
        end
    end)
    
    return btn
end

-- Create Keybind
function AzureUI:CreateKeybind(config)
    local Window = self
    config = config or {}
    
    local frame = Create("Frame", {
        Parent = self.Content or self,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 42)
    })
    
    local container = Create("Frame", {
        Parent = frame,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundColor3 = Theme.Secondary,
        BackgroundTransparency = 0.5
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = container})
    
    Create("UIPadding", {
        Parent = container,
        PaddingLeft = UDim.new(0, 12),
        PaddingRight = UDim.new(0, 12)
    })
    
    Create("UIListLayout", {
        Parent = container,
        FillDirection = Enum.FillDirection.Horizontal,
        Padding = UDim.new(0, 10),
        VerticalAlignment = Enum.VerticalAlignment.Center
    })
    
    Create("TextLabel", {
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.6, 0, 1, 0),
        Font = Enum.Font.Gotham,
        Text = config.Name or "Keybind",
        TextColor3 = Color3.fromRGB(220, 220, 220),
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local keyButton = Create("TextButton", {
        Parent = container,
        BackgroundColor3 = Theme.Background,
        Size = UDim2.new(0, 80, 0, 30),
        Font = Enum.Font.GothamBold,
        Text = config.Default and config.Default.Name or "None",
        TextColor3 = Theme.Text,
        TextSize = 12,
        AutoButtonColor = false
    })
    Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = keyButton})
    Create("UIStroke", {Color = Theme.Accent, Thickness = 1, Transparency = 0.5, Parent = keyButton})
    
    local currentKey = config.Default
    local listening = false
    
    keyButton.MouseButton1Click:Connect(function()
        if listening then return end
        listening = true
        keyButton.Text = "..."
        Tween(keyButton, {BackgroundColor3 = Theme.Accent}, 0.2)
        
        local connection
        connection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Keyboard then
                currentKey = input.KeyCode
                keyButton.Text = currentKey.Name
                listening = false
                Tween(keyButton, {BackgroundColor3 = Theme.Background}, 0.2)
                
                if config.Callback then
                    table.insert(Window.Keybinds, {
                        Key = currentKey,
                        Callback = config.Callback
                    })
                end
                
                connection:Disconnect()
            end
        end)
    end)
    
    return frame
end

return AzureUI
